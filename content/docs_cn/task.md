---
title: "任务表示"
---
# 任务

> 这里的信息描述了 TaskChampion 公开的任务模型。
> 有关权威信息，请参阅 [TaskChampion 文档](https://github.com/GothenburgBitFactory/taskchampion/blob/main/docs/src/tasks.md)。

任务在内部存储为具有字符串键和值的键/值映射。
所有字段都是可选的：`Create` 操作创建一个空任务。
显示层应在必要时应用适当的默认值。

## 原子性

同步过程不支持读取-修改-写入操作。
例如，假设通过读取标签列表、添加标签并写回结果来更新标签。
这将被捕获为包含修订标签列表的 `Update` 操作。
假设在不同的副本中进行了两个这样的 `Update` 操作，必须进行调和：
 * `Update("d394be59-60e6-499e-b7e7-ca0142648409", "tags", "oldtag,newtag1", "2020-11-23T14:21:22Z")`
 * `Update("d394be59-60e6-499e-b7e7-ca0142648409", "tags", "oldtag,newtag2", "2020-11-23T15:08:57Z")`

此调和的结果将是 `oldtag,newtag2`，而用户几乎肯定打算 `oldtag,newtag1,newtag2`。

下面给出的关键名称避免了这个问题，允许用户更新（如添加标签或删除依赖关系）在单个 `Update` 操作中表示。

## 有效性

_任何_ 键/值映射都是有效的任务。
任务数据的使用者必须尽最大努力解释任何映射，即使它包含明显矛盾的信息。
例如，应将状态为 "completed" 但没有 "end" 键的任务解释为在未知时间完成。

## 表示

整数以十进制表示法存储。

时间戳存储为 UNIX 纪元时间戳，采用整数形式。

## 键

定义了以下键和键格式：

* `status` - 待处理任务为 `P`（默认值）、完成任务为 `C`、删除任务为 `D` 或循环任务为 `R` 之一
* `description` - 任务的单行摘要
* `modified` - 上次修改此任务的时间
* `start` - 上次启动此任务的时间（没有 `start` 键的任务未激活）
* `end` - 如果存在，此任务完成或删除的时间（请注意，此键可能与 `status` 不一致：它可能对待处理任务存在，或对已删除或已完成的任务不存在）
* `tag_<tag>` - 表示此任务具有标签 `<tag>`（值被忽略）
* `wait` - 表示在此之前应隐藏此任务的时间，因为它无法采取行动
* `entry` - 创建任务的时间
* `annotation_<timestamp>` - 值是在给定时间创建的注释；例如 `annotation_1693329505`。
* `dep_<uuid>` - 表示此任务依赖于由 `<uuid>` 标识的另一个任务；值被忽略；例如 `dep_8c4fed9c-c0d2-40c2-936d-36fc44e084a0`

请注意，虽然 TaskChampion 将 `R` 识别为状态，但它不直接实现循环：这由 Taskwarrior 管理。

### UDAs

任何无法识别的键都被视为 "用户定义属性"(UDAs)。
这些属性可用于存储与任务相关的其他数据。
例如，与日历或团队规划服务等其他系统同步任务的应用程序可能会将这些系统的唯一标识符存储为 UDAs。
定义 UDA 的应用程序定义了值的格式。

UDAs _应该_ 具有 `<namespace>.<key>` 形式的命名空间结构，其中 `<namespace>` 标识定义 UDA 的应用程序。
例如，名为 "DevSync" 的服务从 GitHub 同步任务，可能会使用 `devsync.github.issue-id` 等 UDAs。
请注意，Taskwarrior 集成的许多现有 UDAs 不遵循此模式；这些被称为遗留 UDAs。

