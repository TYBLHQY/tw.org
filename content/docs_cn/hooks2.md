---
title: "Taskwarrior - 钩子 v2"
---

# 钩子 v2

这里定义的API是[Hooks v2] API。
此API是TaskWarrior 2.4.3发行版的一部分。

## 事件

无变化。

## 输入

无变化。

## 输出

无变化。

## 退出状态

无变化。

## 接口

无变化。

## 命令行参数

为了支持不断发展的Hooks API，Taskwarrior必须为钩子脚本提供一种机制来确定Hooks API的哪个版本为脚本提供上下文。
预计在未来版本中，将添加新事件，并更改接口。
钩子脚本需要根据API版本采取行动，否则可能会导致与Taskwarrior不兼容。

接口定义了作为标准输入提供的内容，以及在标准输出上期望的内容。
对于`v2`，还将向脚本提供命令行参数。

脚本可能会利用`v2`增强功能来扩展其功能。

| 参数                           | 含义                                                                                                                                                                                                                                     |
|--------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `api:2`                        | 指定的`2`表示Hooks API `v2`。随着Hooks API的演进，这将是一个单调递增的数字。此参数的唯一可能值目前为`2`，因为`v1` API不提供命令行参数。 |
| `args:task ...`                | 脚本对Taskwarrior接收的命令行具有只读访问权限。                                                                                                                                                              |
| `command:add\|done\|sync\|...` | Taskwarrior在其命令行参数中识别的命令。                                                                                                                                                           |
| `rc:/path/to/.taskrc`          | Taskwarrior应用所有覆盖后使用的rc文件的绝对路径。                                                                                                                                                         |
| `data:/path/to/task/folder`    | 包含Taskwarrior数据的文件夹的绝对路径。                                                                                                                                                              |
| `version:x.y.z`                | 调用钩子的Taskwarrior版本。与`task --version`报告的相同，例如`2.4.3`                                                                                                                            |

这是一个模拟钩子脚本调用方式的例子：

     $ ~/.task/hooks/on-xxx.yyy \
        api:2 \
        args:'task rc:~/mytaskrc list' \
        command:add \
        rc:/home/foo/mytaskrc \
        data:/home/foo/.task \
        version:2.4.3 \
        <input.txt \
        >output.txt

脚本可以使用此信息来查看在命令行上指定了备用`rc`文件。

## 向后兼容性

`v1`和`v2` API是相同的，因此任何钩子脚本将在两种情况下不经修改地运行。
这对于未来的版本可能不是真实的。

需要`v2`但在`v1`上下文中运行的脚本应发出警告，表示它无法执行其功能，但不应失败。
